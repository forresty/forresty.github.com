<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Forrest Ye's Blog]]></title>
  <link href="http://forresty.com/atom.xml" rel="self"/>
  <link href="http://forresty.com/"/>
  <updated>2012-12-31T11:19:44+08:00</updated>
  <id>http://forresty.com/</id>
  <author>
    <name><![CDATA[Forrest Ye]]></name>
    <email><![CDATA[afu@forresty.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Belief]]></title>
    <link href="http://forresty.com/blog/2012/12/18/belief/"/>
    <updated>2012-12-18T02:45:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/18/belief</id>
    <content type="html"><![CDATA[<p>Just now when I was reading <em><a href="http://www.amazon.cn/Freedom-from-Fear-Suu-Kyi-Aung-San/dp/0141039493/">Freedom from Fear</a></em>, all of a sudden a <a href="https://twitter.com/fisio/status/276652286682464256">tweet</a> posted by @fisio several days ago popped into my mind.</p>

<p>Mind you, that tweet might hurt your eyes.</p>

<p>It&#8217;s confirmed that <a href="http://www.savetibet.org/resource-center/maps-data-fact-sheets/self-immolation-fact-sheet">95 Tibetans</a> have self-immolated inside Tibet since February 27, 2009.</p>

<p>Most of them are younger than me, yet they had done what they thought was right.</p>

<p>Once I burnt myself with a cigarette butt, trust me, it hurts.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Herd]]></title>
    <link href="http://forresty.com/blog/2012/12/17/herd/"/>
    <updated>2012-12-17T02:46:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/17/herd</id>
    <content type="html"><![CDATA[<p>It&#8217;s so funny to watch people claiming that they are individualists, love <em>Atlas Shrugged</em> or <em>The Fountainhead</em>, or believing in Austrian School of economics running around in groups, meeting random people on the Internet, and enjoying themselves by singing Karaoke together.</p>

<p>I am not against Karaoke BTW.</p>

<p>Wait, maybe they are just not self-confident enough?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Seeking Answers]]></title>
    <link href="http://forresty.com/blog/2012/12/13/seeking-answers/"/>
    <updated>2012-12-13T14:34:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/13/seeking-answers</id>
    <content type="html"><![CDATA[<p>It&#8217;s been more than a year since I took a leave from a startup I helped founded.</p>

<p>After my departure, I decided to dedicate my time to seek answers to a lot of questions, the questions which have been haunting me for a long time already.</p>

<p>I want to know more about the world. I want to know more about everything. I want to know more about myself.</p>

<p>What is the meaning of life? What are my purposes of living? What about my future, the future of the people I care about, my parents and my extended family? What is the future of this country?</p>

<p>I don&#8217;t have any idea.</p>

<p>Good thing is I know money is not my goal. Although I don&#8217;t have a lot, I found that I had enough to sustain myself for a while, so I decided to let it go, and see what would happen.</p>

<p>Since I&#8217;ve never really played enough when I grew up, first I found myself diving into video games. Quickly I found the pleasures of them mildly at best.</p>

<p>Then I took a trip into movies and TV shows. At first I learned a lot from them, namely casual English, western culture, different beliefs and different lifestyles.</p>

<p>But soon I realized that they are the products of pop culture and driven by consumerism. The information and knowledge you can find in them are shallow at best. They are designed so that the majority of the people can grasp them. <a href="http://forresty.com/blog/2012/07/05/on-black-mirror/">I denounced pure consumerism</a>.</p>

<p>Also, there is a chunk load of nihilism in games, movies and TV shows.</p>

<p>Then I submerged into the information overload, and found Twitter to be the heaven of immediate, fragmented, overflown information. Relentlessly I looked for and followed <a href="https://twitter.com/forresty/following">a lot of wonderful people</a>, some of them become my heroes. I observed them closely. I was obsessed with every bit of information they spit out. I want to learn from them.</p>

<p>Also, there is this site called <a href="http://9gag.com">9gag</a>, and through 9gag I discovered <a href="http://reddit.com">Reddit</a>. Where pop culture meets information overload.</p>

<p>But later I realized that <a href="http://forresty.com/blog/2012/11/20/serious/">being a bystander is not fun</a>. And I found patterns emerged from the informations. There is a bigger picture. I <a href="http://forresty.com/blog/2012/11/17/anti-social-at-its-best/">moved</a> <a href="http://forresty.com/blog/2012/12/08/hacker-news/">on</a>.</p>

<p>I <a href="http://forresty.com/blog/2012/10/15/smoking-and-quitting/">smoked and quitted</a>. I tasted weeds. I took risks and experienced a lot of mindless physical pleasures.</p>

<p>I sneak-peeked into religions, and found no peace of mind there.</p>

<p>I bought stuffs, and now I find myself heading back to <a href="http://forresty.com/blog/2012/12/11/my-stuffs/">minimalism</a>.</p>

<p>I realized that this is an age of entertainment. To protest, I enclosed myself with books. Several times I found myself spent consecutive sleepless days and nights reading. Just DEAR (Drop Everything And Read).</p>

<p>I found philosophy. A whole new world.</p>

<p>But still, in the community of book lovers, I found a lot of people retreated into escapism or defeatism.</p>

<p>And now I am so puzzled.</p>

<p>People of the world, I have questions for you:</p>

<p>Working people who are proud of being professional, are you just believing in hedonism, working hard just in order to play harder? Are you an excellent human being or just fighting to become a really, really excellent sheep? Are you self-liberating or just enjoying self annihilation?</p>

<p>Social activists who claim that you are to make China a better place, do you really know what you are doing? Do you know how to build as well as how to pose mass destruction?</p>

<p>Celebrities in China, do you really believe that you are controlling the media, or are you just submitting yourselves to the mass, to this age of entertainment?</p>

<p>Party leaders of the Communist Party of China, have you thought about that you are mortal and just a small chapter in the human history?</p>

<p>Engineers, entrepreneurs and all the producers who are trying to push the human race forward, do you know that you might be doing just the opposite and helping the evil? Are you planning to help the people or just enjoy yourselves?</p>

<p>Everyone else, do you have a purpose of life? Have you given a serious thought about that you are going to die some day, and your time is limited?</p>

<p>Sadly for me, I found that most of my types of people are in the U.S., but my roots remain here in China.</p>

<p>I also found that no matter how wonderful a person was, when he labeled himself as a group member of whatever it is, he often degraded quickly.</p>

<p>Therefore I decided to stand for individualism and fight against any kind of collectivism for as long as I can sustain.</p>

<p>But I still haven&#8217;t found what I am looking for.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ayi Loves You]]></title>
    <link href="http://forresty.com/blog/2012/12/11/ayi-loves-you/"/>
    <updated>2012-12-11T17:26:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/11/ayi-loves-you</id>
    <content type="html"><![CDATA[<p>Recently I read a lot of open source code, some of them are really nice, some of them suck.</p>

<p>Since I have my TextMate 2 set up so trailing whitespace and <code>\t</code> in Ruby files are highlighted, every now and then when I stumble upon those patterns, I find myself fixing them locally, and depending on my mood, I might send them a pull request.</p>

<p>Though I have a keyboard shortcut set up in my TextMate so it&#8217;s just a trivial task for each file, but it&#8217;s really annoying to see them coming up again and again, right?</p>

<p>When yesterday my <a href="https://github.com/capistrano/capistrano/pull/319">pull request to capistrano</a> was rejected and was told by this nice guy called Roy Liu, that rather than fixing them file by file, it&#8217;s preferred to do it in batch.</p>

<p>So today I literally went through the entire project, read through the code, trying to understand them while fixing the styles. Oh man it hurts my eyes.</p>

<p>Obviously some tasks are better done using automation. Thus in a hurry I wrote this little <a href="https://github.com/forresty/ayi">ayi gem</a>.</p>

<p>Basically it clean up codes for you, and I intend to make it do this one thing and do it well.</p>

<p>Of course It&#8217;s now still very early in development, but let&#8217;s hope it will become more and more powerful as time goes by.</p>

<p>Go <a href="https://github.com/forresty/ayi">take a look at it</a> if you are interested.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[My Stuffs]]></title>
    <link href="http://forresty.com/blog/2012/12/11/my-stuffs/"/>
    <updated>2012-12-11T13:52:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/11/my-stuffs</id>
    <content type="html"><![CDATA[<p>I <a href="http://forresty.com/blog/2012/11/17/anti-social-at-its-best/">blogged about simplifying my life</a> and mentioned about a list of my stuffs, since I know some of you might be interested, I am now making it public.</p>

<p><a href="http://forresty.com/stuffs">Here is the list</a>.</p>

<p>It&#8217;s undergoing constant changes of course, I may try, but I make no promises to keep it up-to-date here.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[THINKING OUT LOUD]]></title>
    <link href="http://forresty.com/blog/2012/12/09/thinking-out-loud/"/>
    <updated>2012-12-09T13:55:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/09/thinking-out-loud</id>
    <content type="html"><![CDATA[<p>This world is full of thoughtful thinkers who don&#8217;t speak out loud enough, talkative hyperactive doers who don&#8217;t think enough, passive nihilistic people who hate this world and hate themselves, and mindless lazy people who know nothing but to lamely entertain themselves.</p>

<p>So I say, hey sexy world, I am here to make you a better place.</p>

<p>I intend to think out loud till I feel I&#8217;ve satisfied myself.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MBTI Explained]]></title>
    <link href="http://forresty.com/blog/2012/12/09/mbti-explained/"/>
    <updated>2012-12-09T10:59:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/09/mbti-explained</id>
    <content type="html"><![CDATA[<p>So I <a href="http://forresty.com/blog/2012/12/06/intp/">blogged about me taking online MBTI tests again</a> and found myself have changed from the ENFP type to INTP type and might become an INTJ without telling you guys what MBTI is and wtf are ENFP and INTP and INTJ.</p>

<p>Okay I know most of you are either too lazy or too busy to look into those jargons yourselves, so I am here to give a brief talk about MBTI.</p>

<p>So basically <a href="http://en.wikipedia.org/wiki/Myers-Briggs_Type_Indicator">MBTI</a> is an indicator which reflects your psychological preferences and how you perceive the world and make decisions. It&#8217;s based on the work of <a href="http://en.wikipedia.org/wiki/Carl_Jung">Carl Jung</a> if you are wondering.</p>

<p>There are many free online MBTI tests in languages of your preferences, just Google it yourself. I took several quick ones in both Chinese and English just to make sure the results are consistent.</p>

<p>The MBTI basically categorize people into 16 groups based on 4 sub-types (2 ^ 4 == 16, hence the 4 character type name ENFP or INTJ).</p>

<p>Those sub-types are:</p>

<ul>
<li>Extraversion (E) –  (I) Introversion</li>
<li>Sensing (S) –   (N) Intuition</li>
<li>Thinking (T) –  (F) Feeling</li>
<li>Judging (J) –   (P) Perception</li>
</ul>


<h2>Extraversion (E) – (I) Introversion</h2>

<p>Basically extraverts feels more comfortable when spending time with people, while introverts get their energy from spending time alone.</p>

<h2>Sensing (S) –  (N) Intuition</h2>

<p>People who prefer sensing are data oriented, they prefer to look for details and facts, while intuition people tend to seek the meaning in the underlying theory and principles which are manifested in the data.</p>

<h2>Thinking (T) – (F) Feeling</h2>

<blockquote><p>Thinking and feeling are the decision-making functions. Those who prefer thinking tend to decide things from a more detached standpoint, measuring the decision by what seems reasonable, logical, causal, consistent, and matching a given set of rules. Those who prefer feeling tend to come to decisions by associating or empathizing with the situation, looking at it &#8216;from the inside&#8217; and weighing the situation to achieve, on balance, the greatest harmony, consensus and fit, considering the needs of the people involved. - Wikipedia</p></blockquote>

<p>Therefore thinkers are often perceived to have a bigger ego.</p>

<h2>Judging (J) –  (P) Perception</h2>

<p>Judging and Perception represent the lifestyles you choose. People who prefer perception are generally more passive, seeking to understand the world as it is, while judging people prefer to act, to make a difference.</p>

<h2>About My Types</h2>

<p>I was an ENFP hence I was more of a product manager / program manager type of guy. Oh, and many passionate revolutionaries are of this type.</p>

<p>Since I realized I was not satisfied with that, therefore I changed myself from E to I and from F to T, and now I am an INTP.</p>

<p>By becoming an INTP I find myself in the same group with most scientists and philosophers, but I don&#8217;t like it as of this moment.</p>

<p>Thus I am becoming an INTJ.</p>

<p>Simply put, I prefer to become more like Elon Musk than Larry Page or Sergey Brin or Albert Einstein.</p>

<h2>Final Notes</h2>

<p>MBTI is just a method to group people into sub-groups. Don&#8217;t take it too seriously.</p>

<p>After all, there are only 16 groups, and even if you are in the rarest group, or you may prefer, the most elite group, 1% * 6 billion is still a very large number.</p>

<p>And there are still people like me who are well aware of the system and are willing to hack their own minds, and are capable of taking actions to change their types on demand and have succeeded.</p>

<p>Take that.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hacker News]]></title>
    <link href="http://forresty.com/blog/2012/12/08/hacker-news/"/>
    <updated>2012-12-08T12:48:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/08/hacker-news</id>
    <content type="html"><![CDATA[<blockquote><p>Germany has declared war on Russia. Swimming in the afternoon. -Franz Kafka&#8217;s diary entry of August 2, 1914</p></blockquote>

<p>When you are seeking to understand the fundamental logics and reasons of this world, sooner or later you&#8217;ll come to realize that daily trivial matters are of no importance at all.</p>

<p>Thus I abandoned a private experimental Hacker News iOS app roughly 5 months ago, because I realized that I don&#8217;t want to pay that much attention to news any more.</p>

<p>It&#8217;s now open source on GitHub <a href="https://github.com/forresty/Hackish">https://github.com/forresty/Hackish</a>.</p>

<p>Mind you, the code sucks. It stinks, it smells. I haven&#8217;t touched a single line of Objective-C after that (except spending half an hour to clean it up last night), but I believe I can now easily write at least 5 times better in less than 1/3 of the time.</p>

<p>But still, since I&#8217;ve seen a lot of pretentious people pretending that they know how to write iOS code, I think what the hell, opening this shit up to the world might not make it a worse place.</p>

<p>If you go read it and think &#8220;LOL, this guy sucks&#8221;, then thank you, you motivate me.</p>

<p>I tried to be humble, but this world seems to ignore humble people.</p>

<p>So I say fuck this shit, I&#8217;d better be hated or laughed at than be ignored.</p>

<p>Come judge me.</p>

<p>UPDATE: corrections on Kafka&#8217;s diary. BTW for a good example of well-written iOS client code, check out Cheddar by Sam Soffes <a href="https://github.com/nothingmagical/cheddar-ios">https://github.com/nothingmagical/cheddar-ios</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sweet Tweets]]></title>
    <link href="http://forresty.com/blog/2012/12/07/sweet-tweets/"/>
    <updated>2012-12-07T21:48:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/07/sweet-tweets</id>
    <content type="html"><![CDATA[<blockquote><p>I hate to break it to you, but your product does not depend on elegance of code. It depends on positioning and marketing. Embrace that. - @holman</p></blockquote>

<p><a href="https://twitter.com/holman/status/277004349333467136">https://twitter.com/holman/status/277004349333467136</a></p>

<blockquote><p>Why are engineer founders are on the rise? Businessmen create that which has worked in the past. Engineers create that which has never been. - @kneath</p></blockquote>

<p><a href="https://twitter.com/kneath/status/273869571360956416">https://twitter.com/kneath/status/273869571360956416</a></p>

<blockquote><p>Internet comments would be great if you could filter them by “Has this user accomplished anything? Anything at all?” - @holman</p></blockquote>

<p><a href="https://twitter.com/holman/status/272800396802670592">https://twitter.com/holman/status/272800396802670592</a></p>

<blockquote><p>$PATH is dependency injection for Unix. It doesn’t need to be complicated. - @sstephenson</p></blockquote>

<p><a href="https://twitter.com/sstephenson/status/270673707389841408">https://twitter.com/sstephenson/status/270673707389841408</a></p>

<blockquote><p>What if you designed a web framework around the error messages displayed to developers? - @kneath</p></blockquote>

<p><a href="https://twitter.com/kneath/status/263062829375041536">https://twitter.com/kneath/status/263062829375041536</a></p>

<p>There are reasons why companies like GitHub and 37signals are awesome.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Meditation]]></title>
    <link href="http://forresty.com/blog/2012/12/07/meditation/"/>
    <updated>2012-12-07T20:58:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/07/meditation</id>
    <content type="html"><![CDATA[<p>If you need meditation in order to clear your mind, that&#8217;s called finding focus / getting into the zone.</p>

<p>If you need meditation because you feel a little bit burnt out, that&#8217;s called resting.</p>

<p>If you need meditation because you don&#8217;t know what to do, that&#8217;s called thinking.</p>

<p>If you have work to do but you think you need to meditate, that&#8217;s called procrastination.</p>

<p>If you fell asleep during meditation, that&#8217;s called sleeping.</p>

<p>Steve Jobs practiced meditation, Elon Musk may have done drugs, super heroes in Ayn Rand&#8217;s books smoke. They might helped, but they are not why those people are successful.</p>

<p>Just stop pretending and start to get things done.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[INTP]]></title>
    <link href="http://forresty.com/blog/2012/12/06/intp/"/>
    <updated>2012-12-06T14:38:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/06/intp</id>
    <content type="html"><![CDATA[<p>Just took another MBTI test, it seems now I am an INTP.</p>

<p>Apparently I&#8217;ve changed a lot since last time (roughly 3~4 years ago) I took the test I was an ENFP. I think it&#8217;s likely that I&#8217;ve had stayed ENFPish till last year or so (while recently I gradually moved from Extraversion to Introversion and Feeling to Thinking).</p>

<p>But I might want myself to be an INTJ, since INTJs are more on the &#8220;doer&#8221; side while INTPs are more on the &#8220;thinker&#8221; side.</p>

<p>So, how can I make myself move towards INTJ?</p>

<p>Maybe keep &#8220;thinking&#8221; how is not the right answer, right? ;)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introducing dotjs-pow]]></title>
    <link href="http://forresty.com/blog/2012/12/04/introducing-dotjs-pow/"/>
    <updated>2012-12-04T14:06:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/04/introducing-dotjs-pow</id>
    <content type="html"><![CDATA[<p>I just released a small piece of code called <a href="https://github.com/forresty/dotjs-pow">dotjs-pow</a> on GitHub, before I tell you what it is, let me tell you a short story first.</p>

<p>You see, recently, I read a lot of books. I bought most of them on <a href="http://amazon.cn">amazon.cn</a> since you know, dead-tree versions of Chinese books are dirt cheap.</p>

<p>And also, there is this Chinese site <a href="http://douban.com">douban.com</a>, which has generally pretty reliable Chinese book ratings and reviews, and you know what, they have some nice APIs too!</p>

<p>Since I find myself constantly switching Safari tabs between pages from amazon.cn and douban.com, I started to think that how can I make this easier.</p>

<!-- more -->


<p>Initially, I thought about building a Safari extension, but it is not an elegant solution.</p>

<p>Then I found this awesome piece of code called <a href="https://github.com/defunkt/dotjs">dotjs</a> by GitHub CEO(!) Chris Wanstrath (a.k.a. defunkt), basically it lets you run a custom js file located in your <code>~/.js</code> each time you visit a site.</p>

<p>&#8220;Yes!&#8221;, I think, so in a hurry I installed it (albeit I have to install <a href="https://github.com/wfarr/dotjs.safariextension">dotjs.safariextension</a> as well since defunkt was a Chrome guy) and put following code in my <code>~/.js/amazon.cn.js</code> to put it to a test:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">url</span> <span class="o">:</span> <span class="s1">&#39;http://api.douban.com/book/subjects?alt=json&amp;q=9787533935030&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">type</span> <span class="o">:</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">dataType</span> <span class="o">:</span> <span class="s1">&#39;JSON&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">success</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;yay!&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">failure</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;meh&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>And points my Safari to amazon.cn. As you might have already guessed, I saw this in Safari console:</p>

<p><img src="http://forresty.com/images/Access-Control-Allow-Origin.png" alt="Access-Control-Allow-Origin.png" /></p>

<p>Hmm. Typical.</p>

<p>Since I don&#8217;t control either amazon.cn or douban.com, one solution is that I build an API proxy for api.douban.com.</p>

<p>It&#8217;s quite easy to do so using Sinatra and HTTParty:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;sinatra&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;httparty&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">disable</span> <span class="ss">:protection</span>
</span><span class='line'>
</span><span class='line'><span class="n">get</span> <span class="s1">&#39;/api/douban/book/isbn/:isbn&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">headers</span> <span class="s1">&#39;Access-Control-Allow-Origin&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/json; charset=utf-8&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">HTTParty</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://api.douban.com/book/subjects?alt=json&amp;q=</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:isbn</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>But of course I don&#8217;t want to put the proxy on the Internet! So am I going to run yet another service on my localhost? Hmm, I don&#8217;t like ugly hacks.</p>

<p>Then I realized <code>djsd</code> used by dotjs is just a static file server, and since I already have a Rack-compliant <a href="https://github.com/37signals/pow">Pow</a> running on my machine (as many Rubyists do), why not just build a Pow powered dotjs server, which can also be used to bypass cross-site security protections as well?</p>

<p>Thus <a href="https://github.com/forresty/dotjs-pow">dotjs-pow</a> was born.</p>

<p>And with following codes in my <code>~/.js/amazon.cn.js</code>, job&#8217;s done.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trim</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+|\s+$/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isbnize</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/,.+$/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// http://stackoverflow.com/questions/1408289/best-way-to-do-variable-interpolation-in-javascript</span>
</span><span class='line'><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">supplant</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/{([^{}]*)}/g</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">o</span><span class="p">[</span><span class="nx">b</span><span class="p">];</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">typeof</span> <span class="nx">r</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">r</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">?</span> <span class="nx">r</span> <span class="o">:</span> <span class="nx">a</span><span class="p">;</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;b:contains(&quot;ISBN:&quot;)&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">isbn</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nextSibling</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">isbnize</span><span class="p">();</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">url</span> <span class="o">:</span> <span class="s1">&#39;http://dotjs-pow.dev/api/douban/book/isbn/&#39;</span> <span class="o">+</span> <span class="nx">isbn</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">type</span> <span class="o">:</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">dataType</span> <span class="o">:</span> <span class="s1">&#39;JSON&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">success</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">numRaters</span> <span class="o">=</span> <span class="nx">json</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;gd:rating&#39;</span><span class="p">][</span><span class="s1">&#39;@numRaters&#39;</span><span class="p">];</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">rating</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;gd:rating&#39;</span><span class="p">][</span><span class="s1">&#39;@average&#39;</span><span class="p">]);</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">json</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;link&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;@href&#39;</span><span class="p">];</span>
</span><span class='line'>        <span class="c1">// ratings: 7.9 =&gt; 4_0, 8.5 =&gt; 4_5, 8.6 =&gt; 5_0</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">stars_1</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nx">rating</span> <span class="o">+</span> <span class="mf">1.4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">stars_2</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">rating</span> <span class="o">+</span> <span class="mf">1.4</span><span class="p">)</span> <span class="o">===</span> <span class="nx">stars_1</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">5</span><span class="p">;</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;span class=&quot;swSprite s_star_{stars_1}_{stars_2}&quot; title=&quot;{numRaters} ratings&quot;&gt;&lt;/span&gt;&lt;span&gt;(&lt;a href=&quot;{link}&quot;&gt;{rating}&lt;/a&gt;)&lt;/span&gt;&#39;</span><span class="p">.</span><span class="nx">supplant</span><span class="p">({</span>
</span><span class='line'>          <span class="nx">stars_1</span> <span class="o">:</span> <span class="nx">stars_1</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">stars_2</span> <span class="o">:</span> <span class="nx">stars_2</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">numRaters</span> <span class="o">:</span> <span class="nx">numRaters</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">rating</span> <span class="o">:</span> <span class="nx">rating</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">link</span> <span class="o">:</span> <span class="nx">link</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="nx">html</span><span class="p">).</span><span class="nx">insertAfter</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#btAsinTitle&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">parentNode</span><span class="p">);</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">failure</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;something was wrong.&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Check it out in action (please forgive me, I suck at styling web pages&#8230;):</p>

<p><img src="http://forresty.com/images/amazon.cn-douban-book-api.png" alt="amazon.cn-douban-book-api.png" /></p>

<p>Oh, of course I have to use <a href="https://github.com/forresty/dotjs-pow.safariextension">a modified version</a> of dotjs.safariextension since I changed the server address from http://localhost:3131 to http://dotjs-pow.dev.</p>

<p>The full source code of app.rb (that is, the dotjs-pow server) is as following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#!/usr/bin/env ruby</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;bundler&quot;</span>
</span><span class='line'><span class="no">Bundler</span><span class="o">.</span><span class="n">require</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># sometimes, it is more fun to do it without protection</span>
</span><span class='line'><span class="n">disable</span> <span class="ss">:protection</span>
</span><span class='line'>
</span><span class='line'><span class="n">get</span> <span class="s1">&#39;/js/:js_file&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">headers</span> <span class="s1">&#39;Access-Control-Allow-Origin&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text/javascript; charset=utf-8&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s2">&quot;~/.js/</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:js_file</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span> <span class="k">rescue</span> <span class="s2">&quot;{}&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">get</span> <span class="s1">&#39;/api/douban/book/isbn/:isbn&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">headers</span> <span class="s1">&#39;Access-Control-Allow-Origin&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/json; charset=utf-8&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">HTTParty</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://api.douban.com/book/subjects?alt=json&amp;q=</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:isbn</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you are a hopeless nerd like me, you might want to check it out yourself, visit <a href="https://github.com/forresty/dotjs-pow">dotjs-pow on GitHub</a> now.</p>

<p>BTW, <a href="http://forresty.com/hire">I am currently available for hire</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Prototypal]]></title>
    <link href="http://forresty.com/blog/2012/12/03/prototypal/"/>
    <updated>2012-12-03T00:59:00+08:00</updated>
    <id>http://forresty.com/blog/2012/12/03/prototypal</id>
    <content type="html"><![CDATA[<p>So yesterday I decided it&#8217;s time for me to stop procrastinating and start to learn JavaScript seriously.</p>

<p>(Yes, judge me, I am a Ruby guy but I suck at JavaScript!)</p>

<p>So I picked up this wonderful little book named <em>JavaScript: The Good Parts</em> by the JavaScript guru Douglas Crockford and started to read it through in depth (Yes I read it twice before but never in depth). It was an immense amount of fun I must admit.</p>

<!-- more -->


<p>So just now I was trying to understand why the fuck following codes work:</p>

<h3>Code Sample #1</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">func</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nb">Object</span><span class="p">.</span><span class="nx">method</span><span class="p">(</span><span class="s1">&#39;superior&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">that</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span><span class='line'>  <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">that</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>I only have a vague idea about prototype chaining in JavaScript, that&#8217;s when an object failed to find a property in itself it will start to look it up in its prototype, and prototype&#8217;s prototype and then all the way up to the top.</p>

<p>The codes above implements a <code>superior</code> function which mimics the <code>super</code> in OO world on the object prototype thus enables it on ALL objects, thus making following codes possible:</p>

<h3>Code Sample #2</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">father</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">spec</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>  <span class="nx">that</span><span class="p">.</span><span class="nx">get_name</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">spec</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">that</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">son</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">spec</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="nx">father</span><span class="p">(</span><span class="nx">spec</span><span class="p">);</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">super_name</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">superior</span><span class="p">(</span><span class="s1">&#39;get_name&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">that</span><span class="p">.</span><span class="nx">get_name</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="s1">&#39;proud son of &#39;</span> <span class="o">+</span> <span class="nx">super_name</span><span class="p">();</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">that</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">afu</span> <span class="o">=</span> <span class="nx">father</span><span class="p">({</span><span class="nx">name</span> <span class="o">:</span> <span class="s1">&#39;afu&#39;</span><span class="p">});</span>
</span><span class='line'><span class="nx">afu</span><span class="p">.</span><span class="nx">get_name</span><span class="p">();</span>
</span><span class='line'><span class="c1">// afu</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">afu_junior</span> <span class="o">=</span> <span class="nx">son</span><span class="p">({</span><span class="nx">name</span> <span class="o">:</span> <span class="s1">&#39;afu&#39;</span><span class="p">});</span>
</span><span class='line'><span class="nx">afu_junior</span><span class="p">.</span><span class="nx">get_name</span><span class="p">();</span>
</span><span class='line'><span class="c1">// proud son of afu</span>
</span></code></pre></td></tr></table></div></figure>


<p>I can easily understand the Code Sample #2. The <code>superior()</code> call seems really natural, and that&#8217;s just the way APIs / libraries are supposed to work, right?</p>

<p>So I head back to Code Sample #1 to try to understand how the magic happened behind the scenes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">func</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>This part is easy. It defines a <code>method</code> function on the function prototype so all functions are benefitted from it, any function calls the <code>method()</code> gets its prototype assigned a function as a property. So far so good.</p>

<p>But why <code>Object.method()</code> works??</p>

<p>Well, the answer, unlike the stupid poor me, you might already knew, is that the <code>Object</code> is a function.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">typeof</span> <span class="nb">Object</span> <span class="o">===</span> <span class="kd">function</span>
</span><span class='line'><span class="c1">// true</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// in case you are wondering, this is truthy as well:</span>
</span><span class='line'><span class="k">typeof</span> <span class="nb">Function</span> <span class="o">===</span> <span class="kd">function</span>
</span><span class='line'><span class="c1">// true</span>
</span></code></pre></td></tr></table></div></figure>


<p>I felt my brain had just exploded. Wow. So I did some more experiments:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// So, following expressions are all truthy:</span>
</span><span class='line'><span class="k">typeof</span> <span class="nb">Function</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span>
</span><span class='line'><span class="k">typeof</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span>
</span><span class='line'><span class="k">typeof</span> <span class="nb">Object</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span>
</span><span class='line'><span class="k">typeof</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span>
</span><span class='line'><span class="k">typeof</span> <span class="p">{}</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// And more fun:</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">func</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">obj</span><span class="p">.</span><span class="nx">hello</span><span class="p">;</span>
</span><span class='line'><span class="c1">// undefined</span>
</span><span class='line'>
</span><span class='line'><span class="nx">func</span><span class="p">.</span><span class="nx">hello</span><span class="p">;</span>
</span><span class='line'><span class="c1">// undefined</span>
</span><span class='line'>
</span><span class='line'><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hello</span> <span class="o">=</span> <span class="s1">&#39;sweetie&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">obj</span><span class="p">.</span><span class="nx">hello</span><span class="p">;</span>
</span><span class='line'><span class="c1">// sweetie</span>
</span><span class='line'><span class="nx">obj</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">;</span>
</span><span class='line'><span class="c1">// { superior: [Function], hello: &#39;sweetie&#39; }</span>
</span><span class='line'>
</span><span class='line'><span class="nx">func</span><span class="p">.</span><span class="nx">hello</span><span class="p">;</span>
</span><span class='line'><span class="c1">// sweetie</span>
</span><span class='line'><span class="nx">func</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">;</span>
</span><span class='line'><span class="c1">// { [Function: Empty] method: [Function] }</span>
</span><span class='line'><span class="nx">func</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">;</span>
</span><span class='line'><span class="c1">// { superior: [Function], hello: &#39;sweetie&#39; }</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Sneak peek into Object and Function using Safari (courtesy of my friend @Leaskh):</span>
</span><span class='line'><span class="nb">Object</span><span class="p">;</span>
</span><span class='line'><span class="c1">// function Object() {</span>
</span><span class='line'><span class="c1">//   [native code]</span>
</span><span class='line'><span class="c1">// }</span>
</span><span class='line'>
</span><span class='line'><span class="nb">Function</span><span class="p">;</span>
</span><span class='line'><span class="c1">// function Function() {</span>
</span><span class='line'><span class="c1">//   [native code]</span>
</span><span class='line'><span class="c1">// }</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// This is interesting:</span>
</span><span class='line'><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'><span class="c1">// { superior: [Function], hello: &#39;sweetie&#39; }</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Yes they are all truthy:</span>
</span><span class='line'><span class="nx">obj</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'><span class="nx">func</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'><span class="nx">func</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>So basically, hacking a <code>method()</code> function onto <code>Function.prototype</code> enables it for all functions including <code>Object</code>, and hacking a <code>superior()</code> function with invocation of <code>method()</code> on <code>Object</code> hacks it onto <code>Object.prototype</code> thus enables it for all objects.</p>

<p>So, the Code Sample #1 is exactly the same as:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">superior</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">that</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span><span class='line'>  <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">that</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Per the <code>this</code> binding rules, this line in Sample Code #2</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">super_name</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">superior</span><span class="p">(</span><span class="s1">&#39;get_name&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>retrieves the <code>get_name()</code> function in <code>that</code> which carefully protects <code>that</code> in its closure and is ready to be called with <code>arguments</code>. Neat!</p>

<p>So I think I just figured out some of the most basic ideas about why JavaScript is called a prototypal language and how its prototype chaining really works. (Right? Right??)</p>

<p>This reminds me the moment of ecstasy when I first understood Ruby object / class / singleton-class hierarchies. Aha moments like this is one of the reasons why it is so fascinating to be working in this field.</p>

<p>Yes, my brain hurts now and I need to rest. And yes I &lt;3 programming.</p>

<p>TL;DR:</p>

<p>TIL in JavaScript functions are objects, and Object is a function.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Serious]]></title>
    <link href="http://forresty.com/blog/2012/11/20/serious/"/>
    <updated>2012-11-20T11:16:00+08:00</updated>
    <id>http://forresty.com/blog/2012/11/20/serious</id>
    <content type="html"><![CDATA[<p>Last night, when I was having dinner with my girlfriend at a restaurant, a waiter accidentally dropped a receipt to the floor when passing by our table.</p>

<p>I know this is just a little thing and probably had already happened to you before. But in this case, what would you do?</p>

<p>Well. For me, I picked it up, took a look at it, then gave it back to the waiter then standing behind a counter not far away.</p>

<p>And I thought that was the end of the story.</p>

<p>But one hour later, we found out that my girlfriend had left her cell phone at the restaurant, and apparently someone was trying to reach us in order to return the phone.</p>

<p>I rushed back to the restaurant and found the very same waiter waiting for me, smiling, and gave the phone back to me.</p>

<p>To remind you, this is China, a place where when you&#8217;ve lost something you are not likely to get it back.</p>

<p>I was very happy.</p>

<p>Then I recalled yet another story happened to me one night several weeks ago.</p>

<p>I was taking a walk near my apartment, and all of a sudden an old man tripped and fell onto the floor. I rushed forward without a thought to check on him.</p>

<p>Luckily he was not hurt at all, and a bit surprisingly, he was happy seeing me coming.</p>

<p>Later I remembered helping elder people who accidentally fell in China might cost you a fortune.</p>

<p>Then I thought about a <a href="http://book.douban.com/review/1133203/">review</a> of <a href="http://book.douban.com/subject/4729583/">野火集</a> I read on Douban yesterday, it was the top review on the book on Douban. To quote some of her text:</p>

<p>「既然关心除了关心便没有其他的价值，不会让我快乐，不会让我安详，不会让我感悟，甚至鲜血也已不能带来恐慌，哭泣也已不能带来动容，迫害也已不能带来愤怒，你说，我关心它们还有什么意义？」</p>

<p>「于是我继续关心自己的一切，以及自己以外的一切八卦。」</p>

<p>I want to tell you that you are wrong. It&#8217;s totally okay to be selfish, but it&#8217;s not ok to be aloof.</p>

<p>If you really care about yourself, you will not be satisfied by merely stay away from everything you don&#8217;t like.</p>

<p>Because there is always something small you can do everyday to make this world a better place, and who knows when what you do will come back to you and light up your day.</p>

<p>As time goes by I find myself getting more and more serious about everything. Why so serious, you may ask.</p>

<p>Because I care.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[anti-social at its best]]></title>
    <link href="http://forresty.com/blog/2012/11/17/anti-social-at-its-best/"/>
    <updated>2012-11-17T19:52:00+08:00</updated>
    <id>http://forresty.com/blog/2012/11/17/anti-social-at-its-best</id>
    <content type="html"><![CDATA[<p>I have a dream.</p>

<p>A wild, seemly unrealistic dream.</p>

<p>For the past few months, though it seemed I was making progress everyday, the dream is still far far away.</p>

<p>So I think I should make plans. Plans and actions make dreams come true, so my dream would become a goal.</p>

<p>I wrote down the goal and its dependencies using the DOT language, then I generated a huge colored tree-like digraph as desktop background with Graphviz.</p>

<p>The parts I&#8217;ve accomplished or achieved are in green color, those I am working on are in light-green, those I should pay more attentions are in pink or red.</p>

<p>Okay now it&#8217;s more like a game.</p>

<p>Next I started to simplify my life aggressively.</p>

<p>I made a list of stuffs I can&#8217;t live without, and started to think how to shorten the list and improve it.</p>

<p>I made and a list of stuffs I really don&#8217;t need, and started to get rid of them.</p>

<p>Okay now everything seems to be in proper order.</p>

<p>I realized just as there is meta-programming, there is meta-living. Knowledge-wise, information on Twitter is the most fragmented and disorganized, so let&#8217;s go meta-level, to blogs, to books, to code-reading, to actually working on the problems.</p>

<p>Okay now I understand things better.</p>

<p>I simplified my daily schedule, I reduced the number of websites I visit everyday, I pay fewer attentions to news, I unfollowed a lot of people.</p>

<p>Okay now I have a peaceful mind.</p>

<p>And now I am happy.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Nikola Tesla on Thomas Edison]]></title>
    <link href="http://forresty.com/blog/2012/10/27/nikola-tesla-on-thomas-edison/"/>
    <updated>2012-10-27T16:17:00+08:00</updated>
    <id>http://forresty.com/blog/2012/10/27/nikola-tesla-on-thomas-edison</id>
    <content type="html"><![CDATA[<p>Remember this famous quote from Thomas Edison describing his timeless efforts on trying to invent the first commercially practical light bulb?</p>

<blockquote><p>&#8220;I have not failed. I&#8217;ve just found 10,000 ways that won&#8217;t work.&#8221;</p></blockquote>

<p>Well, found this on Wikipedia:</p>

<blockquote><p> When Thomas Edison died in 1931, Tesla contributed the only negative opinion to the New York Times, buried in an extensive coverage of Edison&#8217;s life:</p>

<p>He had no hobby, cared for no sort of amusement of any kind and lived in utter disregard of the most elementary rules of hygiene  &#8230; His method was inefficient in the extreme, for an immense ground had to be covered to get anything at all unless blind chance intervened and, at first, I was almost a sorry witness of his doings, knowing that just a little theory and calculation would have saved him 90 percent of the labor. But he had a veritable contempt for book learning and mathematical knowledge, trusting himself entirely to his inventor&#8217;s instinct and practical American sense.</p></blockquote>

<p>Really, I can&#8217;t say which is better, but this particular difference between engineering-types and business-types is very interesting indeed.</p>

<p>Wikipedia links:</p>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Nikola_Tesla">Nikola Tesla</a></li>
<li><a href="http://en.wikipedia.org/wiki/History_of_the_light_bulb#History_of_the_light_bulb">History of the light bulb</a></li>
<li><a href="http://en.wikipedia.org/wiki/Thomas_Edison">Thomas Edison</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sociopath]]></title>
    <link href="http://forresty.com/blog/2012/10/25/sociopath/"/>
    <updated>2012-10-25T17:14:00+08:00</updated>
    <id>http://forresty.com/blog/2012/10/25/sociopath</id>
    <content type="html"><![CDATA[<p>Just saw this on quora:</p>

<p><a href="http://www.quora.com/Ayn-Rand/Why-do-so-many-engineering-types-with-poor-social-skills-think-Ayn-Rand-is-great">http://www.quora.com/Ayn-Rand/Why-do-so-many-engineering-types-with-poor-social-skills-think-Ayn-Rand-is-great</a></p>

<p>It certainly makes these <strong>people people</strong> feel good by denouncing us sociopaths.</p>

<p>Well, I <strong>love</strong> <em>Atlas Shrugged</em> and <em>The Fountainhead</em>, though I don&#8217;t quite like her, thus the title of the question doesn&#8217;t really apply to me. It&#8217;s just seeing the very wording of this question and the top answer reminds me how much I don&#8217;t like most people.</p>

<p>I am a sociopath, and I am quite comfortable with it.</p>

<p>I really wish I can block topics such as <strong>People Skills</strong> on Quora.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rainy Day]]></title>
    <link href="http://forresty.com/blog/2012/10/22/rainy-day/"/>
    <updated>2012-10-22T14:39:00+08:00</updated>
    <id>http://forresty.com/blog/2012/10/22/rainy-day</id>
    <content type="html"><![CDATA[<p>I never learnt to handle rainy days well.</p>

<p>Woke up in the morning after a late night&#8217;s work, only to find it raining outside, like today.</p>

<p>Check the time, looks like I&#8217;ve already got 8 hours of sleep. But I don&#8217;t feel energized, or fully recharged like I should. Not at all. The colors outside the window are not right: instead of a bright blue sky, white clouds, green lawn and trees, everything is gray. Colorless. No happy kids running around, no dogs or cats chasing each other, no birds singing and dancing with enlightenment. Silence.</p>

<p>The lower temperature, the lack of energy in the air, the dim light, the monotone of raindrops falling make me feel grumpily at ease. But I don&#8217;t want to rest, I want to sit at my desk working. I don&#8217;t come to this world to just stay lying in bed, I am here to make a dent in the universe.</p>

<p>I find myself lack of appetite. I should&#8217;ve forced myself to eat more this morning.</p>

<p>Storm is much better. Staying inside during stormy weather makes you feel happy, because you are glad that unlike other creatures out in the wild, you have a nice shelter with eletricity and hot water to keep you safe. It makes you feel strong.</p>

<p>But on rainy day I feel weak. And I hate feeling weak.</p>

<p>I decided to get out and go for a walk in the nearby Century Park, and it turned out to be a bad decision. It only makes me feel smaller and weaker. How can you feel stronger as a man by being forced to walk a long way in the tall trees, without man-made concrete buildings insight in this cold, dark and damp afternoon?</p>

<p>I rushed back home to a big cup of hot tea.</p>

<p>Maybe I should just learn to pay more attentions to weather forecasts?</p>

<p>But even if I know it is going to rain, what am I going to do about it?</p>

<p>I don&#8217;t want to be controlled by weather, or other people, or anything. I don&#8217;t want to be controlled at all.</p>

<p>So next time I woke up to such weather, I shall force myself to leave my bed immediately, get the music of my morning playlist playing out loud, turn on as many lights as possible, make myself a cup of hot chocolate + coffee and take a hot shower. It shall do the trick.</p>

<p>You can try, but you will never defeat me.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Cassandra and Ruby]]></title>
    <link href="http://forresty.com/blog/2012/10/18/cassandra-and-ruby/"/>
    <updated>2012-10-18T11:36:00+08:00</updated>
    <id>http://forresty.com/blog/2012/10/18/cassandra-and-ruby</id>
    <content type="html"><![CDATA[<p>I&#8217;ve been working on a project that requires the usage of Cassandra and Ruby for some time already, and the process is at the same time quite painfully slow and rewarding for me.</p>

<!-- more -->


<p>To be honest, working with Cassandra using Ruby is not a pleasant experience, especially for a not-so-experienced programmer like me. IMHO the main problems are:</p>

<ol>
<li><p>Cassandra itself, is not so wonderful as promised. Sitting on the AP side of the CAP theorem, that is, unlike traditional RDBMSs or newer NoSQL breeds such as MongoDB and Redis, Cassandra is always available and partitioning-tolerant, while sacrificing consistency. Being open-sourced by Facebook and later adopted by Twitter and Reddit etc, it solves very specific problems for them: inbox search for Facebook, real-time analytics for Twitter, and persistent cache for Reddit. THEY DON&#8217;T USE IT AS MAIN STORAGE ENGINES AND THERE ARE NOT MANY PEOPLE IN THE WILD USING IT. That alone can tell something.</p></li>
<li><p>Cassandra is not very Ruby-friendly, or better put, there is not a huge community of Ruby users playing with it, perhaps due to somewhat conflicts in philosophy? Unlike widely available options of open source client libraries for other storage engines, most notably ActiveRecord from Rails for traditional RDBMS, or Mongoid for MongoDB, there are only low-level libraries such as thrift_client gem and cassandra gem by Twitter, the only good high-level library I can find is data-axle&#8217;s fork of cassandra_object, which only has 28 watchers on GitHub. So in that sense, I do feel lonely a little bit, good thing is I&#8217;ve already gotten used to that.</p></li>
</ol>


<p>Well, this is not a post about the downside of using Cassandra with Ruby, so I&#8217;d just stop the complaint. If I am really as good at coding and hacking as I imagined myself to be, I would be much happier. So I only have myself to blame.</p>

<p>So back to the main topic.</p>

<p>Thrift interface is Cassandra&#8217;s lowest level API interface, it&#8217;s quite like the ProtocolBuffer from Google or the (seemingly more sassy) MessagePack. Though CQL is later added as an interface option, the CQL channel is actually built upon thrift interface - that is, every time you execute a CQL query against a Cassandra node, your query is packaged as a Thrift RPC call to that node, and you get your results back as a packet of binary thrift formatted data. Performance-wise, various people have done experiments and the difference between raw thrift calls and cql queries is not apparent, which is quite understandable. Besides Thrift, there used to be an alternative RPC interface based on Avro which is a bit similar to Thrift, the reasons why it was introduced in the first place and why later got dropped I never bother myself to look into.</p>

<p>Since Cassandra is written in Java, so naturally its Thrift server is implemented in Java. So typically when you use Cassandra with Ruby, you are going down on this route:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cassandra gem (from Twitter, in Ruby) ---&gt;
</span><span class='line'>thrift_client gem (Twitter, simply a wrapper around thrift gem, Ruby) ---&gt;
</span><span class='line'>thrift gem (from the Thrift team, part of Thrift source code, Ruby & C) ---&gt;
</span><span class='line'>[TCP/IP or Unix socket, possibly over the inter-webz] ---&gt;
</span><span class='line'>Thrift server (from the Cassandra team, in Java) ---&gt;
</span><span class='line'>Cassandra internal API (Cassandra, Java) ---&gt;
</span><span class='line'>Cassandra (hooray!)</span></code></pre></td></tr></table></div></figure>


<p>Well, what I am doing (and a bunch of other people) is throwing on top of these another layer, the data-axle&#8217;s fork of cassandra_object, which is modeled based on the awesome ActiveModel project introduced in Rails 3 and uses the cassandra gem from Twitter internally, and then trying to tame it to my specific needs, and hack yet another layer of business logic on top of it. So you can imagine when things went wrong, I&#8217;d be forced to go down each layer trying to figure out what the fuck is going on. Since there is no a huge community, I am thankful that my hair is short so I don&#8217;t have the risks of getting them pulled off by the irritated me.</p>

<p>But it&#8217;s quite fun and so far I am still enjoying it. I see myself forking the top most layers, learning the hell out of every bit of technical details, and hopefully I don&#8217;t need to go down to the very bottom. During the whole process I am often overwhelmed by a mixed feeling: the hatred towards myself and the regret that I didn&#8217;t become a hard-core tech nerd as early as when I am still in college, and the joy of challenging myself to understand every piece of details down the road and finally getting close to it.</p>

<p>Let see how far it goes.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Smoking and Quitting]]></title>
    <link href="http://forresty.com/blog/2012/10/15/smoking-and-quitting/"/>
    <updated>2012-10-15T20:58:00+08:00</updated>
    <id>http://forresty.com/blog/2012/10/15/smoking-and-quitting</id>
    <content type="html"><![CDATA[<p>How long must you have managed not to light up a single cigarette can you consider yourself successfully gotten rid of the addiction to smoking? One month? Three months? Or a year?</p>

<p>For me, as a self-identified soft-core smoker, only one month into forcing myself not to smoke, already have I started to notice a lot of interesting things happening around me.</p>

<p>For a starter, I begin to notice that people are smoking everywhere. Every single one of them. Every single burning cigarette within my eyesight, with every hand holding it. Even the butts on the ground caught my attentions as well. And all the no-smoking signs. And all the ashtrays, in public places or not.</p>

<p>It is quite interesting actually, a bit similar to the effects of weed smoking, but instead of being able to focus on whatever you wanted to see, you only see cigarettes. I don’t know for sure, but maybe a better analogy is when you are so horny all you see is just boobs and naked skins and short skirts. Our brain is such a fascinating device.</p>

<p>My body is telling me that it crave for cigarettes, or more accurately, nicotine. Feeling compelled to do things is not a happy experience. As mortal human, we have already submitted ourselves to the necessity of daily dose of foods and sleep, to be added up with occasional urges of to work, to spend money, to talk to people and to engage in sexual activities. We could argue whether or not we need any more of these mental and physical burdens, to such extent that we create and cast more and more upon ourselves. Can you imagine yourself living without electricity? Without hot water? Without Internet access? To have desires is healthy, to want something new or different is understandable and can be encouraged, but what about to have addictions that we normally or naturally don’t need?</p>

<p>People generally wanted to be free. We improved our technologies on growing foods so the majority of us can be freed from being forced to stay in the field all day, we invented telephones and the Internet so we can be freed from waiting a long time for mail responses and enduring difficulties to access to knowledges, we subverted evil regimes so we can be freed from mandate taxes and bullshits forcefully posed upon us. Our flesh so fragile that we cannot endure the pressure of hundreds of meters under water, yet we’ve sent men to the deepest corners of the oceans with a depth of one hundred times more; metal is more than one thousand times heavier than air, yet we’ve built machines using these stardusts that can carry us up into the air and across the seas.</p>

<p>Occasional smoking is good and relaxing, and it helps you gain and maintain focus during work. Most important characters in Ayn Rand’s books smoke. As a man-worshipping reason-loving atheist, Ayn Rand’s notion that smoking as a symbol of the power of man being able to control fire in finger tips makes much sense to me. But being forced to do so regularly really bugs me. Caffeine too, with it we enjoy a boost of productivity, but without it we fell deeply into a state of grumpy rapidly. Why, don’t we have choices? So is there really such a thing as freewill? Or are these addictions a price we need to pay in order to fully enjoy the advancements we’ve achieved? Can we take off our helmets while conquering the stars and galaxies? Can we?</p>

<p>Being alive is a very unnatural state of existence, since we weren’t born before we arrived in this world as a conscious creature, and we will be dead and remain dead after only a couple of years of living. Time is short, maybe I should not worry so much, so long as I know I love to read books and write down random pseudo-intellectual thoughts such as this, so long as I enjoy a lot reading and writing codes, so long as I understand that there are people to love and things to hate, so long as I see there are so much to learn that perhaps one million lifetimes are not enough, so long as I believe there are a lot to fight for and fight against and I am willing to do that, maybe I should just yield to this seemingly tiny issue?</p>

<p>Or maybe I will never yield.</p>

<p>Should I?</p>
]]></content>
  </entry>
  
</feed>
